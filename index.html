<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>EEG-Blinks by VisLab</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">EEG-Blinks</h1>
      <h2 class="project-tagline">BLINKER: Automated blink detector for EEG</h2>
      <a href="https://github.com/VisLab/EEG-Blinks" class="btn">View on GitHub</a>
      <a href="https://github.com/VisLab/EEG-Blinks/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/VisLab/EEG-Blinks/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="introduction-to-the-blinker-pipeline" class="anchor" href="#introduction-to-the-blinker-pipeline" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction to the BLINKER pipeline</h1>

<p>BLINKER and associated tools are an automated pipeline for detecting eye blinks in EEG and calculating various properties of these blinks. BLINKER takes as input an arbitrary number of signals, which can include ordinary EEG channels, EOG channels and independent components (IC), determines which signals have acceptable blinks and determining the optimal signal for determining blinks. BLINKER also has facilities for merging blinks calculating from different source signals and for plotting individual blinks to facilitate manual evaluation and synchronization of EEG with video and eye tracking. BLINKER is designed to be run in a completely automated way. </p>

<p>The major sections of this document are:</p>

<ul>
<li>
<a name="Introduction">Introduction</a> 

<ul>
<li>
<a href="#Requirements">Requirements</a><br>
</li>
<li>
<a href="#Citing">Citation</a><br>
</li>
<li><a href="#Installing">Installation</a></li>
</ul>
</li>
<li><a href="#Plugin">Running BLINKER as an EEGLAB plugin</a></li>
<li><a href="#Script">Running as a script</a></li>
<li>Algorithm

<ul>
<li>(steps, meaning of parameters for each step)</li>
</ul>
</li>
<li>Description of BLINKER structures

<ul>
<li>
<a href="#blinks">The blinks structure</a><br>
</li>
<li><a href="#blinkFits">The blinkFits structure</a></li>
<li><a href="#blinkProperties">The blinkProperties structure</a></li>
<li><a href="#blinkStatistics">The blinkStatistics structure</a></li>
</ul>
</li>
</ul>

<h3>
<a id="requirements" class="anchor" href="#requirements" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a name="Requirements">Requirements</a>
</h3>

<p>The BLINKER pipeline relies on the MATLAB Signal Processing toolbox, the MATLAB Statistics toolbox and EEGLAB, a freely-available MATLAB toolbox for processing EEG. EEGLAB is available from  <a href="http://scn.ucsd.edu/eeglab">http://scn.ucsd.edu/eeglab</a>. Various high-level BLINKER wrapper functions assume that the EEG data is provided as an EEGLAB EEG structure and that channel locations are provided in the EEG.chanlocs structure. However, low-level processing functions work directly
on signals.</p>

<h3>
<a id="citing-blinker" class="anchor" href="#citing-blinker" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a name="Citing">Citing BLINKER</a>
</h3>

<p>BLINKER is freely available under the GNU General Public License. 
Please cite the following publication if using:  </p>

<blockquote>
<p>Kleifges K, Bigdely-Shamlo N, Kerick S, and Robbins KA<br>
BLINKER: Large-scale automated analysis of ocular indices extracted from EEG  </p>
</blockquote>

<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a name="Installation">Installation</a>
</h3>

<p>The BLINKER pipeline can be run in two ways --- as a standalone toolbox or as an EEGLAB plugin. To run in standalone mode, simply download the BLINKER code, found in the EEG-Blinks github repository, and add the <code>blinker</code> directory and all of its subdirectories to the MATLAB path. Regardless of how you run BLINKER, EEGLAB will need to be in your path.</p>

<h2>
<a id="blinker-as-an-eeglab-plugin" class="anchor" href="#blinker-as-an-eeglab-plugin" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a name="Plugin">BLINKER as an EEGLAB plugin</a>
</h2>

<p>You can install BLINKER as an EEGLAB plugin by unzipping the <code>blinker1.0.0</code> directory into the plugins directory of your EEGLAB installation. When you start EEGLAB, BLINKER will be available.</p>

<h2>
<a id="running-the-blinker-pipeline-from-eeglab" class="anchor" href="#running-the-blinker-pipeline-from-eeglab" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running the BLINKER pipeline from EEGLAB</h2>

<p>Load an EEG dataset to be processed using the <code>Load dataset</code> submenu under the <code>File</code> menu of EEGLAB. The BLINKER pipeline 
can be found under the EEGLAB Tools submenu:  </p>

<p><img src="https://raw.githubusercontent.com/VisLab/EEG-Blinks/gh-pages/images/EEGLAB_Menu.png" alt="BLINKER from EEGLAB">  </p>

<p><img src="https://raw.githubusercontent.com/VisLab/EEG-Blinks/gh-pages/images/BLINKER_Plugin.png" alt="BLINKER menu"><br>
<img src="./images/BLINKER_Plugin.png" alt="BLINKER menu"> </p>

<p><img src="https://vislab.github.io/EEG-Blinks/images/BLINKER_Plugin.png" alt="BLINKER menu">  </p>

<p>[Code linke](<a href="https://github.com/Vislab/EEG-Blinks/">https://github.com/Vislab/EEG-Blinks/</a>
<img src="https://github.com/VisLab/EEG-Blinks/tree/gh-pages/images/BLINKER_Plugin.png" alt="BLINKER menu">  </p>

<h2>
<a id="running-blinker-as-a-script-in-batch-processing-mode" class="anchor" href="#running-blinker-as-a-script-in-batch-processing-mode" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a name="Script">Running BLINKER as a script in batch processing mode</a>
</h2>

<p>While it is possible to run BLINKER as a plugin from EEGLAB, BLINKER is meant to be run in batch processing mode to analyze large collections of EEG. While it is possible to run BLINKER using the low-level functions, the easiest way to run BLINKER is to put your EEG dataset into an EEGLAB EEG structure.</p>

<p><strong>Example</strong><br>
Run BLINKER outside of EEGLAB but bring up a GUI to set parameters:</p>

<blockquote>
<p><code>[EEG, com, blinks, blinkFits, blinkProperties, blinkStatistics, params] = pop_blinker(EEG);</code>  </p>
</blockquote>

<p><strong>Example</strong><br>
Run BLINKER without manual intervention, using all of the default parameters:</p>

<blockquote>
<p>`[EEG, com, blinks, blinkFits, blinkProperties, blinkStatistics,  params] = pop_blinker(EEG, struct());  </p>
</blockquote>

<p><strong>Example</strong><br>
The previous example uses all of the default values, including defaults for metadata such as the <code>subjectID</code>. Usually you will want to override the defaults. When you are going to override defaults it is good to start with a complete <code>params</code> structure with all of the default values filled in:  </p>

<blockquote>
<p><code>params = checkBlinkerDefaults(struct(), getBlinkerDefaults(EEG));</code> </p>
</blockquote>

<p><strong>Example</strong><br>
The following example starts with a default <code>params</code> structure and then overrides some of the values related to controlling the output and to dataset metadata:  </p>

<blockquote>
<p><code>params = checkBlinkerDefaults(struct(), getBlinkerDefaults(EEG));</code><br>
<code>params.subjectID = blinkFiles(k).subjectID;</code><br>
<code>params.experiment = blinkFiles(k).experiment;</code><br>
<code>params.uniqueName = blinkFiles(k).uniqueName;</code><br>
<code>params.task = blinkFiles(k).task;</code><br>
<code>params.fileName = blinkFiles(k).fileName;</code><br>
<code>params.startDate = blinkFiles(k).startDate;</code><br>
<code>params.startTime = blinkFiles(k).startTime;</code><br>
<code>params.blinkerSaveFile = [blinkIndDir filesep  blinkFiles(k).blinkFileName '_' typeBlinks '.mat'];</code><br>
<code>params.dumpBlinkerStructures = true;</code><br>
<code>params.blinkerDumpDir = blinkIndDir;</code><br>
<code>params.dumpBlinkImages = false;</code><br>
<code>params.dumpBlinkPositions = false;</code><br>
<code>params.keepSignals = false;</code><br>
<code>params.showMaxDistribution = false;</code><br>
<code>params.verbose = false;</code><br>
<code>params.excludeLabels = {'a1', 'a2', 'vehicle position'}; 
</code>[EEG, com, blinks, blinkFits, blinkProperties, blinkStatistics, params] = pop_blinker(EEG, params); </p>
</blockquote>

<p><em>Example</em> 
Run BLINKER outside of EEGLAB but bring up a GUI to set parameters:</p>

<h3>
<a id="parameters-related-to-dataset-metadata" class="anchor" href="#parameters-related-to-dataset-metadata" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Parameters related to dataset metadata</h3>

<p><strong><code>srate</code></strong>
 A positive scalar giving the sampling rate of the signal in Hz. 
If an EEG structure is passed to <code>getBlinkerDefaults</code>, the default value is <code>EEG.srate</code>. 
Otherwise, the default 1.</p>

<p><strong><code>subjectID</code></strong><br>
String identifying the subject for the dataset. BLINKER uses this ID to combine short datasets from same session to get blink maxima distribution.<br>
[String (default is 'Subject1_Task1_Experiment1_Rep1’)]</p>

<p><strong><code>uniqueName</code></strong><br>
String uniquely identifying this dataset<br>
[String (default is 'Unknown')]  </p>

<p><strong><code>experiment</code></strong> 
 String identifying the experiment. 
[String (default is 'Experiment1')]</p>

<p><strong><code>task</code></strong><br>
Name of task performed in this dataset<br>
[String (default is 'Task1')]  </p>

<p><strong><code>startDate</code></strong><br>
String giving the start date of dataset in dd-mmm-yyyy format<br>
[String (default is '01-Jan-2016')]</p>

<p><strong><code>startTime</code></strong><br>
String giving the start time in 24 hour hh:mm:ss format.<br>
[String (default is '00:00:00')]</p>

<p><strong><code>signalTypeIndicator</code></strong><br>
String specifying the type of signals from which to extract blinks.<br>
[String with possible values are 'UseNumbers' or 'UseLabels' or 'UseICs' (default is 'UseNumbers')]</p>

<p><strong><code>signalNumbers</code></strong><br>
Vector of numbers of the channel numbers to try as potential signals if signalTypeIndicator is 'UseNumbers'.<br>
[Row vector of positive integers less than the number of channels (default 1:number of channels)]</p>

<p><strong><code>signalLabels</code></strong><br>
Cell array of names of channels to try as potential signals if signalTypeIndicator is 'UseLabels'.<br>
[Row cell array of channel labels (default: {'fp1', 'f1', 'fp2', 'fz', 'fpz', 'f3', 'f4', 'f2'})]</p>

<p><strong><code>excludeLabels</code></strong><br>
Cell array of the names of signals to exclude from consideration.<br>
[Row cell array of channel labels (default: {'exg5', 'exg6', 'exg7', 'exg8', 'vehicle position'})]</p>

<h3>
<a id="parameters-for-controlling-what-is-output" class="anchor" href="#parameters-for-controlling-what-is-output" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Parameters for controlling what is output</h3>

<p><strong><code>dumpBlinkerStructures</code></strong><br>
Logical flag indicating whether to save all of the blinker structures in a file.<br>
[Logical (default: true)]</p>

<p><strong><code>showMaxDistribution</code></strong><br>
Logical flag indicating whether to show a figure with a histogram of blink maxima.<br>
[Logical (default: true)]</p>

<p><strong><code>dumpBlinkImages</code></strong><br>
Logical flag indicating whether to dump pictures of the individual blinks in a directory, indexed by an HTML file.<br>
[Logical (default:true).]</p>

<p><strong><code>dumpBlinkPositions</code></strong><br>
A logical flag indicating whether to dump a text file of the frame left zeros, and frames of blink maxima frames and times.<br>
[Logical (default:false).]</p>

<p><strong><code>fileName</code></strong><br>
The full path name of the input EEG file.<br>
[char]</p>

<p><strong><code>blinkerSaveFile</code></strong><br>
The full path name of the file to save the BLINKER structures and parameters in.<br>
[char (default: [pwd theNameOfDataset '_blinks.mat']).]</p>

<p><strong><code>blinkerDumpDir</code></strong><br>
The path of the directory in which to dump pictures of blinks. Usually this will be empty to start with.<br>
[char (default: [pwd filesep 'blinkDump'].)</p>

<p><strong><code>numberMaxBins</code></strong>
Number of bins used to display histograms of blink maxima
[Scalar numeric positive (default: 80)]      </p>

<h1>
<a id="blinker-algorithm-overview" class="anchor" href="#blinker-algorithm-overview" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>BLINKER Algorithm Overview</h1>

<p>This section discusses the algorithm and the setting of the various parameters.</p>

<h3>
<a id="processing-steps" class="anchor" href="#processing-steps" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Processing steps</h3>

<ol>
<li>Extract potential blinks of each candidate signal.</li>
<li>Calculate landmarks of potential blinks.</li>
<li>Reject signals with low signal-to-noise (SNR) ratios.</li>
<li>Calculate blink maximum amplitude distributions.</li>
<li>Select the "best" candidate signal as the "used" signal.</li>
<li>Calculate the blink properties and blink shapes for the "used" signal.</li>
<li>Calculate the ocular indices for the "used" signal.</li>
</ol>

<h2>
<a id="extract-potential-blinks-of-each-candidate-signal" class="anchor" href="#extract-potential-blinks-of-each-candidate-signal" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Extract potential blinks of each candidate signal</h2>

<p>Each candidate signal is band-passed filtered in the interval [1, 20] Hz prior to blink detection. BLINKER then determines the intervals during which the signal is greater than 1.5 standard deviations above the overall signal mean. These intervals form the potential blinks. We consider only potential blinks that are longer than 50 ms and are at least 50 ms apart. These criteria eliminate many small rapid eye movements without appearing to eliminate actual blinks.</p>

<p>Parameters related to this stage:  </p>

<p><strong><code>lowCutoffHz</code></strong><br>
The lower edge of the band pass filter.<br>
[Nonnegative scalar (default 1).]</p>

<p><strong><code>highCutoffHz</code></strong><br>
The upper edge of the band pass filter.
[Nonnegative scalar (default 20).]</p>

<p><strong><code>stdThreshold</code></strong><br>
Number of robust standard deviations above the mean the signal for potential blinks.<br>
[Scalar numeric positive (default is 1.5).]</p>

<h2>
<a id="calculate-landmarks-of-potential-blinks" class="anchor" href="#calculate-landmarks-of-potential-blinks" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Calculate landmarks of potential blinks.</h2>

<p>Having identified the potential blinks, BLINKER then applies a fitting process to find specified landmarks for each blink and saves information about each candidate blink in a structure. Fig. 2, produced by BLINKER using its blink plot overlay function, illustrates the blink fitting process for a prototypical blink. In the example of Fig. 2, BLINKER overlays signals corresponding to an independent component (IC), an EEG channel, and an EOG channel for the same blink. The plot overlay function accepts a cell array of input signals and uses the first signal to compute and display the blink landmarks. In the example plot, the maximum value in the interval occurs at frame 100786 (the max-frame), which is 393.695 seconds from the beginning of the dataset. If two or more points in the interval achieve the maximum value, the max-frame is the first. The up-stroke is the interval from the last zero crossing before max-frame to the max-frame.  The down-stroke is the interval after the max-frame to the first zero crossing after max-frame. The left-base (frame 100755 at time 393.57 seconds) marks the start of the up-stroke, and the right-base marks the end of the down-stroke. BLINKER marks the left-base and right-base with green crosses. Two other landmarks of interest are the left-zero, which is the frame at which the up-stroke crosses 0 and the right-zero, which is the frame at which the down-stroke crosses zero. 
BLINKER computes for each potential blink in a candidate signal the best linear fits for the inner 80% of the up-stroke and down-stroke, respectively. The quality (R2) of the correlation of these lines (denoted by left-R2 and right-R2, respectively) with the actual blink trajectory is a measure of the closeness of the potental blink to a stereotypical blink. For the blink of Fig. 2, the correlations to the up-stroke and the down-stroke are both 0.999. BLINKER computes the intersection of these fit two lines (the tent-peak) and displays the perpendicular line using a thin black line. The tent-peak is slightly forward of and above the maximum of the actual blink trajectory (the blink-peak) in a stereotypical blink. The values R2, as well as the relative position of the tent-peak to the blink-peak, provide simple tests of the how closely the blink resembles a stereotypical blink. </p>

<h2>
<a id="reject-signals-with-low-signal-to-noise-snr-ratios" class="anchor" href="#reject-signals-with-low-signal-to-noise-snr-ratios" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Reject signals with low signal-to-noise (SNR) ratios.</h2>

<p>After determining the landmarks for all of the potential blinks in a candidate signal, BLINKER computes the blink-amplitude ratio (BAR) for the signal. The blink-amplitude ratio is the average amplitude of the signal between the blink left-zero and right-zero zero crossings divided by the average amplitude of the positive portion of the signal “outside” the blink. (The blink excursion is always in the positive direction.) The left outer portion consists of the interval from the right-zero of the previous blink (or the beginning of the signal for the first blink) to the left-zero of this blink. The right outer portion consists of the interval from the right-zero of this blink to the left-zero of the next blink (or the end of the signal for the last blink). BLINKER rejects signals that have a BAR outside a specified range ([3, 50] by default). We have found empirically that signals with BAR values in the range [5, 20] usually capture blinks reasonably well. BAR is a measure of the signal-to-noise ratio (SNR) of the blink to the background in a candidate signal.</p>

<p><strong>Parameters:</strong>  </p>

<p><strong><code>blinkAmpRange</code></strong><br>
The range of blink amplitude ratios allowed for candidate signals.<br>
[Two-element row vector of positive values (default: [3, 50]).] </p>

<h2>
<a id="calculate-blink-maximum-amplitude-distributions-and-eliminate-out-of-range-signals" class="anchor" href="#calculate-blink-maximum-amplitude-distributions-and-eliminate-out-of-range-signals" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Calculate blink maximum amplitude distributions and eliminate out of range signals</h2>

<p>Fig. 3 shows examples of the maximum amplitude distributions for three typical cases. The green line shows the distribution of maximum amplitudes of all potential blinks, and the thick light gray line shows the distribution of maximum amplitudes of the “good” blinks (up-stroke and down-stroke R2 &gt; 0.90). The medium thick gray line shows the distribution of maximum amplitudes of the “better” blinks (up-stroke and down-stroke R2 &gt; 0.95), and the black line shows the distribution of maximum amplitudes of the “best” blinks (up-stroke and down-stroke R2 &gt; 0.98). The magenta line shows the blinks selected by BLINKER.  These “used” blinks have up-stroke and down-stroke R2 &gt; 0.90 and satisfy the maximum amplitude distribution criterion and the pAVR criterion.  These later criteria allow BLINKER to separate normal blinks from eye movements. 
The maximum amplitude distribution criterion enforces the bell-shaped maximum distribution that normal blinks have around the median of the “best” blinks. This criteria eliminates blinks whose R2 is low and whose amplitudes are far from the best blink median. By default, BLINKER eliminates “best blinks” more than five robust standard deviations from the median and “good” blinks more than two robust standard deviations away from this median. Here we define the robust standard deviation as 1.4826 times the median absolute deviation from the median. Fig. 3 displays the median of the “best” blinks with a gray vertical line and the locations that are two robust standard deviations from this median with dashed gray lines. </p>

<p>The pAVR criterion captures the difference the sharp rising edge of saccades and the more curved rise of normal blinks. We have found empirically that blink candidates with pAVR &lt; 3 do not correspond to normal blinks, but rather saccades and certain short, fast eye movements.  </p>

<p><strong>Parameters:</strong> 
<strong><code>minGoodBlinks</code></strong>
The minimum number of good blinks a signal must have to be considered a candidate signal.<br>
[Non negative scalar (default: 10).]</p>

<p><strong><code>goodRatioThreshold</code></strong><br>
The minimum value of <code>goodRatio</code> needed for a signal to be considered non-marginal.
[Non negative scalar (default: 0.7).]</p>

<p><strong><code>pAVRThreshold</code></strong>
The minimum value of pAVR needed to be a blink rather than an eye movement.
[Positive scalar (default: 3).]</p>

<p><strong><code>correlationThresholdTop</code></strong>
Minimum correlation of blink with linear fits in order to be considered a "best" blink.<br>
[Non negative scalar between 0 and 1 (Default: 0.98).]</p>

<p><strong><code>correlationThresholdBottom</code></strong>
Minimum correlation of blink with linear fits in order to be considered a "good" blink.<br>
[Non negative scalar between 0 and 1 (Default: 0.90).]</p>

<p><strong><code>correlationThresholdMiddle</code></strong><br>
Minimum correlation of blink with linear fits in order to be considered a "better" blink.<br>
[Non negative scalar between 0 and 1 (Default: 0.95).]</p>

<h2>
<a id="select-the-best-candidate-signal-as-the-used-signal" class="anchor" href="#select-the-best-candidate-signal-as-the-used-signal" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Select the "best" candidate signal as the "used" signal.</h2>

<p><strong><code>keepSignals</code></strong>
     getRules(false, {'logical'}, {}, ...
       ['Keep signals that pass the blink amplitude ratio test' ...
       ' regardless of good ratio (for combination)']),  ...  </p>

<h2>
<a id="calculate-the-blink-properties-and-blink-shapes-for-the-used-signal" class="anchor" href="#calculate-the-blink-properties-and-blink-shapes-for-the-used-signal" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Calculate the blink properties and blink shapes for the "used" signal.</h2>

<h2>
<a id="calculate-the-ocular-indices-for-the-used-signal" class="anchor" href="#calculate-the-ocular-indices-for-the-used-signal" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Calculate the ocular indices for the "used" signal.</h2>

<p><strong><code>shutAmpFraction</code></strong>
      getRules(0.90, {'numeric'}, {'scalar', 'nonnegative', '&lt;=', 1}, ...
       'Fraction of maximum amplitude to reach for time shut'),  ...</p>

<p><strong><code>zThresholds</code></strong>
     getRules([0.90, 2; 0.98, 5], {'numeric'}, {'positive', 'ncols', 2}, ...
     'Rows contain correlation and max z-score threshold pairs for determining good blinks'), ...</p>

<p><strong><code>ICSimilarityThreshold</code></strong>
     getRules(0.85, {'numeric'}, {'nonnegative', '&lt;=', 1}, ...
     'How similar and IC has to be to an eye IC to be a candidate'), ...</p>

<p><strong><code>ICFOMThreshold</code></strong>
Mean difference in IC scalp map amplitude of front versus rear hemispheres (used to select blink ICs)
[Scalar numeric positive (default: 1)]</p>

<h3>
<a id="calling-sequence-for-line-noise-removal" class="anchor" href="#calling-sequence-for-line-noise-removal" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Calling sequence for line noise removal</h3>

<p>The <code>cleanLineNoise</code> function takes two structures in and produces two output structures. The <code>signal</code> structure
includes a <code>.data</code> field and an <code>.srate</code> field. The <code>signal</code> structure is compatible with an EEGLAB EEG structure, but does not rely on any of the other EEGLAB fields. The data field should be channels x frames. </p>

<p>As with all functions in the pipeline, the algorithm parameters are passed in a structure.  </p>

<blockquote>
<p><code>[signal, lineNoiseOut] = cleanLineNoise(signal)</code><br>
<code>[signal, lineNoiseOut] = cleanLineNoise(signal, lineNoiseIn)</code>  </p>
</blockquote>

<h1>
<a id="blinker-structures" class="anchor" href="#blinker-structures" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>BLINKER structures</h1>

<p>![BLINKER menu]</p>

<h2>
<a id="the-blinks-structure" class="anchor" href="#the-blinks-structure" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a name="blinks">The blinks structure</a>
</h2>

<p>The <code>blinks</code> structure holds basic information about the dataset, the candidate signals and the positions of
the potential blinks in the candidate signals. </p>

<p><strong><code>fileName</code></strong>
 String with the full path name of the file from which the blinks were computed</p>

<p><strong><code>srate</code></strong>
 Sampling rate in Hz of the signal</p>

<p><strong><code>subjectID</code></strong>
 String identifying the subject from which the dataset was recorded. This field is used for display purposes and for combining datasets taken from a single subject in one session to improve estimates of blink maximum distribution.</p>

<p><strong><code>experiment</code></strong>
 String identifying the experiment or data collection that this dataset is part of.</p>

<p><strong><code>uniqueName</code></strong>
 String uniquely identifying this dataset within the context of the analysis. Usually this will be a combination of the experiment, subject, task, replicate, and other identifying information. This string is used for display purposes and for lookup of datasets within a combined analysis.</p>

<p><strong><code>task</code></strong>
 String identifying the task performed by the subject for this dataset.</p>

<p><strong><code>startTime</code></strong>
 Double value giving the days (to within) from xxx.</p>

<p><strong><code>signalData</code></strong>
 Structure with details of the candidate signals and potential blink positions.</p>

<p><strong><code>usedSignal</code></strong>
 Integer identifying the signal that is selected as the "best" signal for blinks. Usually this will be a channel number within the original dataset or the number of an IC within an independent component decomposition associated with the dataset. A negative value indicates that the results of the calculation were marginal and that the signal may not have captured the blinks reliability.</p>

<p><strong><code>status</code></strong>
 String indicated the status of the blink calculation. A value of "success" means that blinks were successfully computed, although the results may be marginal. A value of "failed" means that the algorithm could not extract blinks from any of the candidate signals provide.</p>

<h3>
<a id="the-signaldata-substructure-of-blinks" class="anchor" href="#the-signaldata-substructure-of-blinks" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a name="signalData">The signalData substructure of blinks</a>
</h3>

<p>The <code>signalData</code> is a structure array containing information about candidate signals for the dataset. The individual fields are:</p>

<p><strong><code>signalType</code></strong>
 String indicating the type of signal this is. Usually the <code>signalType</code> will indicate how the initial candidate signals were specified and will have a value 'SignalNumbers', 'SignalLabels', `ICs'. </p>

<p><strong><code>signalNumber</code></strong>
A unique integer identifier of the signal within the dataset as a whole (for example the channel number of the IC number.)
[A positive integer.]</p>

<p><strong><code>signalLabel</code></strong>
A unique identifier of the signal within the dataset as a whole (for example the channel label). BLINKER automatically creates labels for independent components: 'IC1', 'IC2', etc.
[A string.]</p>

<p><strong><code>numberBlinks</code></strong><br>
The number of potential blinks detected in this signal.
[A nonnegative integer.]</p>

<p><strong><code>numberGoodBlinks</code></strong><br>
An integer giving the number of "good" potential blinks detected in this signal. These blinks must have
left and right R^2 values at greater than <code>correlationThresholdBottom</code> (0.90 by default).
[A nonnegative integer.]</p>

<p><strong><code>blinkAmpRatio</code></strong><br>
A positive value indicating the blink-amplitude ratio for this signal.</p>

<p><strong><code>cutoff</code></strong><br>
A positive value estimating the boundary between the blink maximum distributions of the "good" blink candidates and the other blink candidates. If this value is well away from the <code>bestMedian</code>, the dataset is likely to have  good separation between blinks and eye movements.</p>

<p><strong><code>bestMedian</code></strong><br>
A positive value giving the median blink maximum amplitude of the best candidate blinks. These blinks must have
left and right R^2 values at greater than <code>correlationThresholdTop</code> (0.98 by default).</p>

<p><strong><code>bestRobustStd</code></strong><br>
A positive number giving the 1.486 times the median absolute deviation from the median (mad) of the best candidate blinks. These blinks must have left and right R^2 values at greater than <code>correlationThresholdTop</code> (0.98 by default).</p>

<p><strong><code>goodRatio</code></strong><br>
A positive numeric value between 0 and 1 indicating the fraction of blinks whose maximum amplitude is within two robust standard deviations of the median of the best blinks that are "good" blinks. This is a measure of how badly eye movements confound the maximum amplitude distribution.</p>

<p><strong><code>signal</code></strong><br>
The timeseries for this signal.</p>

<p><strong><code>blinkPositions</code></strong><br>
A 2 x n array with the frame numbers of the starts and ends of intervals defining the portion of the n potential blinks that exceeds the threshold. The blink maximum should be in this interval.</p>

<h2>
<a id="the-blinkfits-structure" class="anchor" href="#the-blinkfits-structure" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a name="blinkFits">The blinkFits structure</a>
</h2>

<p>The <code>blinkFits</code> structure array holds basic shape information for a set of potential blinks. In <code>extractBlinkProperties</code> function returns this structure for the potential blinks of the used signal that meet specific quality criteria. Values that are undefined, have value <code>NaN</code>. The fields are:</p>

<p><strong><code>number</code></strong><br>
The number of the potential blink within the corresponding blinks structure.
[A positive numeric value.]</p>

<p><strong><code>maxFrame</code></strong><br>
The frame number of the first maximum amplitude of this blink.
[A positive numeric value.]</p>

<p><strong><code>maxValue</code></strong><br>
A numeric value giving the maximum value of the blink.</p>

<p><strong><code>leftOuter</code></strong><br>
The frame number of the left outer reach of the blink.
[A positive numeric value.]</p>

<p><strong><code>rightOuter</code></strong><br>
The frame number of the right outer reach of the blink.
[A positive numeric value.]</p>

<p><strong><code>leftZero</code></strong><br>
The frame number of the left zero crossing of the blink.
[A positive numeric value.]</p>

<p><strong><code>rightZero</code></strong><br>
The frame number of the right zero crossing of the blink.
[A positive numeric value.]</p>

<p><strong><code>leftBase</code></strong><br>
The frame number of the left local minimum of the blink.
[A positive numeric value.]</p>

<p><strong><code>rightBase</code></strong><br>
The frame number of the right local minimum of the blink.
[A positive numeric value.]</p>

<p><strong><code>leftBaseHalfHeight</code></strong><br>
The coordinate of the signal halfway (in height) between the blink maximum and the left base value.
[A positive numeric value.]</p>

<p><strong><code>rightBaseHalfHeight</code></strong><br>
The coordinate of the signal halfway (in height) between the blink maximum and the right base value.<br>
[A positive numeric value.]</p>

<p><strong><code>leftZeroHalfHeight</code></strong>  </p>

<p><strong><code>rightZeroHalfHeight</code></strong>  </p>

<p><strong><code>leftRange</code></strong>  </p>

<p><strong><code>rightRange</code></strong>  </p>

<p><strong><code>leftSlope</code></strong><br>
[A negative value or NaN if the tent line doesn't exist.]</p>

<p><strong><code>rightSlope</code></strong><br>
Slope of the right blink tent line.
[A negative value or NaN if the tent line doesn't exist.]</p>

<p><strong><code>averLeftVelocity</code></strong>  </p>

<p><strong><code>averRightVelocity</code></strong>  </p>

<p><strong><code>leftR2</code></strong><br>
The correlation of the left tent line with the 80% blink upstroke. 
[A numeric value or NaN if the tent line doesn't exist.]</p>

<p><strong><code>rightR2</code></strong><br>
The correlation of the right tent line with the 80% blink downstroke. 
[A numeric value or NaN if the tent line doesn't exist.]</p>

<p><strong><code>xIntersect</code></strong><br>
The x-coordinate of the intersection of the left and right tent line with the x-axis.<br>
[A numeric value or NaN if the tent line doesn't exist.]</p>

<p><strong><code>yIntersect</code></strong><br>
The y-coordinate of the intersection of the left and right tent line with the x-axis.<br>
[A numeric value or NaN if the tent line doesn't exist.]</p>

<p><strong><code>leftXIntercept</code></strong><br>
An integer giving the frame number of the intersection of the left tent line with the x-axis (or NaN if the tent line doesn't exist).</p>

<p><strong><code>rightXIntercept</code></strong><br>
An integer giving the frame number of the intersection of the right tent line with the x-axis (or NaN if the tent line doesn't exist).</p>

<h2>
<a id="the-blinkproperties-structure" class="anchor" href="#the-blinkproperties-structure" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a name="blinkProperties">The blinkProperties structure</a>
</h2>

<p>The <code>blinkProperties</code> structure array holds basic ocular characteristics for a set of potential blinks. The <code>extractBlinkProperties</code> function returns this structure for the potential blinks of the used signal that meet specific quality criteria. Values that are undefined, have value <code>NaN</code>. The fields are:</p>

<p><strong><code>durationBase</code></strong><br>
Length of the blink in seconds calculated as the difference between <code>rightBase</code> and <code>leftBase</code>.</p>

<p><strong><code>durationZero</code></strong><br>
<strong><code>durationTent</code></strong><br>
<strong><code>durationHalfBase</code></strong><br>
<strong><code>durationHalfZero</code></strong><br>
<strong><code>interBlinkMaxAmp</code></strong><br>
<strong><code>interBlinkMaxVelBase</code></strong><br>
<strong><code>interBlinkMaxVelZero</code></strong><br>
<strong><code>negAmpVelRatioBase</code></strong><br>
<strong><code>posAmpVelRatioBase</code></strong><br>
<strong><code>negAmpVelRatioZero</code></strong><br>
<strong><code>posAmpVelRatioZero</code></strong><br>
<strong><code>negAmpVelRatioTent</code></strong><br>
<strong><code>posAmpVelRatioTent</code></strong><br>
<strong><code>'timeShutBase</code></strong><br>
<strong><code>'timeShutZero</code></strong><br>
<strong><code>timeShutTent</code></strong><br>
<strong><code>closingTimeZero</code></strong><br>
<strong><code>reopeningTimeZero</code></strong><br>
<strong><code>closingTimeTent</code></strong><br>
<strong><code>reopeningTimeTent</code></strong><br>
<strong><code>peakTimeBlink</code></strong><br>
<strong><code>peakTimeTent</code></strong><br>
<strong><code>peakMaxBlink</code></strong><br>
<strong><code>peakMaxTent</code></strong>  </p>

<h2>
<a id="the-blinkstatistics-structure" class="anchor" href="#the-blinkstatistics-structure" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a name="blinkStatistics">The blinkStatistics structure</a>
</h2>

<p>The <code>blinkProperties</code> structure array holds basic ocular characteristics for a set of potential blinks. The <code>extractBlinkProperties</code> function returns this structure for the potential blinks of the used signal that meet specific quality criteria. Values that are undefined, have value <code>NaN</code>. header = {'mean', 'median', 'std', 'mad', 'goodMean', 'goodMedian', ...
               'goodStd', 'goodMad'};The fields are:</p>

<p>'fileName', nan, ...
            'subjectID', nan, 'task', nan, 'uniqueName', nan, ...
            'srate', nan, 'startTime', nan, ...
            'usedNumber', nan, 'usedLabel', nan, 'status', nan, ...
            'seconds', nan, 'numberBlinks', nan, 'numberGoodBlinks', nan, ... ...
            'goodRatio', nan, 'header', nan, ...
            'pAVRZ', nan, 'nAVRZ', nan, 'durationZ', nan, ...
            'durationB', nan, 'durationT', nan, ...
            'durationHZ', nan, 'durationHB', nan, 'blinksPerMin', nan);</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/VisLab/EEG-Blinks">EEG-Blinks</a> is maintained by <a href="https://github.com/VisLab">VisLab</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
